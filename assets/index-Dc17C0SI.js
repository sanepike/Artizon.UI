import{_ as w}from"./Modal-CATy3_Vg.js";import{d as I,a as M,A as v,c as b,_ as $,r as A,b as a,o as i,e as s,g,f as k,t as r,w as h,i as C,G as _,H as q,C as V,D as P,n as E,E as Q}from"./index-CjOS9C8z.js";import{u as D}from"./cart-SGFbNxIs.js";import{u as N}from"./orders-Cr-DL9_g.js";import"./api-dTaot8wZ.js";const T=I({name:"CartPage",components:{Modal:w},setup(){const e=M(),t=D(),f=N(),u=v(!1),y=v(!1),c=v(""),l=v(""),p=b(()=>t.items),o=b(()=>t.items.reduce((n,d)=>n+d.price*d.quantity,0)),m=n=>{t.updateQuantity(n.id,n.quantity+1)},O=n=>{n.quantity>1&&t.updateQuantity(n.id,n.quantity-1)},S=n=>{confirm("Remove this item from cart?")&&t.remove(n.id)},F=()=>(l.value="",c.value.trim()?!0:(l.value="Please enter a shipping address",!1));return{cartItems:p,subtotal:o,loading:u,showCheckoutModal:y,shippingAddress:c,addressError:l,increaseQuantity:m,decreaseQuantity:O,removeItem:S,placeOrder:async()=>{if(F()){u.value=!0;try{const n={items:p.value.map(d=>({product_id:d.id,quantity:d.quantity})),shipping_address:c.value.trim()};await f.placeOrder(n),t.clear(),alert("Order placed successfully!"),e.push("/orders/customer")}catch(n){alert(n.message||"Failed to place order. Please try again.")}finally{u.value=!1,y.value=!1}}}}}}),B={class:"cart-page"},R={class:"cart-header"},U={key:0,class:"items-count"},Y={key:0,class:"empty-cart"},z={key:1,class:"cart-content"},G={class:"cart-items"},H={class:"item-image"},L=["alt","src"],j={class:"item-details"},J={class:"item-price"},K={class:"quantity-controls"},W=["disabled","onClick"],X={class:"quantity"},Z=["onClick"],x=["onClick"],ss={class:"item-total"},ts={class:"cart-summary"},es={class:"summary-details"},os={class:"summary-row"},ns={class:"summary-row total"},rs={class:"checkout-section"},as=["disabled"],is={class:"form-group"},ls={key:0,class:"error-text"},ds={class:"order-items"},us={class:"order-total"},cs={class:"form-actions"},ps=["disabled"];function ms(e,t,f,u,y,c){const l=A("router-link"),p=w;return i(),a("div",B,[s("header",R,[t[5]||(t[5]=s("h1",null,"Shopping Cart",-1)),e.cartItems.length>0?(i(),a("p",U,r(e.cartItems.length)+" item(s) in cart ",1)):k("",!0)]),e.cartItems.length===0?(i(),a("div",Y,[t[7]||(t[7]=s("h2",null,"Your cart is empty",-1)),t[8]||(t[8]=s("p",null,"Add some products to your cart to get started!",-1)),g(l,{class:"continue-shopping",to:"/"},{default:h(()=>[...t[6]||(t[6]=[C(" Continue Shopping ",-1)])]),_:1})])):(i(),a("div",z,[s("div",G,[(i(!0),a(_,null,q(e.cartItems,o=>(i(),a("div",{key:o.id,class:"cart-item"},[s("div",H,[s("img",{alt:o.name,src:o.image_urls[0]},null,8,L)]),s("div",j,[s("h3",null,r(o.name),1),s("p",J,"₹"+r(o.price.toFixed(2)),1),s("div",K,[s("button",{class:"quantity-btn",disabled:o.quantity<=1,onClick:m=>e.decreaseQuantity(o)}," - ",8,W),s("span",X,r(o.quantity),1),s("button",{class:"quantity-btn",onClick:m=>e.increaseQuantity(o)}," + ",8,Z)]),s("button",{class:"remove-btn",onClick:m=>e.removeItem(o)}," Remove ",8,x)]),s("div",ss," ₹"+r((o.price*o.quantity).toFixed(2)),1)]))),128))]),s("div",ts,[t[13]||(t[13]=s("h2",null,"Order Summary",-1)),s("div",es,[s("div",os,[t[9]||(t[9]=s("span",null,"Subtotal",-1)),s("span",null,"₹"+r(e.subtotal.toFixed(2)),1)]),t[11]||(t[11]=s("div",{class:"summary-row"},[s("span",null,"Shipping"),s("span",null,"Free")],-1)),s("div",ns,[t[10]||(t[10]=s("span",null,"Total",-1)),s("span",null,"₹"+r(e.subtotal.toFixed(2)),1)])]),s("div",rs,[s("button",{class:"checkout-btn",disabled:e.loading,onClick:t[0]||(t[0]=o=>e.showCheckoutModal=!0)},r(e.loading?"Processing...":"Proceed to Checkout"),9,as),g(l,{class:"continue-shopping-link",to:"/"},{default:h(()=>[...t[12]||(t[12]=[C(" Continue Shopping ",-1)])]),_:1})])])])),g(p,{modelValue:e.showCheckoutModal,"onUpdate:modelValue":t[4]||(t[4]=o=>e.showCheckoutModal=o),title:"Complete Your Order"},{default:h(()=>[s("form",{class:"checkout-form",onSubmit:t[3]||(t[3]=V((...o)=>e.placeOrder&&e.placeOrder(...o),["prevent"]))},[s("div",is,[t[14]||(t[14]=s("label",{for:"shippingAddress"},"Shipping Address",-1)),P(s("textarea",{id:"shippingAddress","onUpdate:modelValue":t[1]||(t[1]=o=>e.shippingAddress=o),class:E({error:e.addressError}),required:"",rows:"4"},null,2),[[Q,e.shippingAddress]]),e.addressError?(i(),a("span",ls,r(e.addressError),1)):k("",!0)]),s("div",ds,[t[16]||(t[16]=s("h3",null,"Order Items",-1)),(i(!0),a(_,null,q(e.cartItems,o=>(i(),a("div",{key:o.id,class:"order-item"},[s("span",null,r(o.name)+" × "+r(o.quantity),1),s("span",null,"₹"+r((o.price*o.quantity).toFixed(2)),1)]))),128)),s("div",us,[t[15]||(t[15]=s("strong",null,"Total:",-1)),s("strong",null,"₹"+r(e.subtotal.toFixed(2)),1)])]),s("div",cs,[s("button",{class:"cancel-btn",type:"button",onClick:t[2]||(t[2]=o=>e.showCheckoutModal=!1)}," Cancel "),s("button",{class:"submit-btn",disabled:e.loading,type:"submit"},r(e.loading?"Placing Order...":"Place Order"),9,ps)])],32)]),_:1},8,["modelValue"])])}const ks=$(T,[["render",ms],["__scopeId","data-v-79a2cce9"]]);export{ks as default};
