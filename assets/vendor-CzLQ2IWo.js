import{d as I,a as _,A as u,k as $,_ as N,b as d,o as r,e as s,f as C,t as l,G as S,H as h,C as U,n as y}from"./index-CjOS9C8z.js";import{ordersApi as P}from"./api-dTaot8wZ.js";const V=I({name:"VendorOrdersPage",setup(){const e=_(),t=u([]),g=u(!1),v=u(null),p=u(1),f=u(1),a=u(!1),n=u(null),c=u(""),m=u(!1),O=[{value:"PLACED",label:"Placed",description:"Order has been placed and is awaiting processing"},{value:"SHIPPED",label:"Shipped",description:"Order has been shipped and is on the way"},{value:"DELIVERED",label:"Delivered",description:"Order has been delivered to the customer"},{value:"CANCELLED",label:"Cancelled",description:"Order has been cancelled"}],b=async()=>{g.value=!0,v.value=null;try{const o=await P.getVendorOrders(p.value,10);t.value=o.orders||[],p.value=o.page||1,f.value=o.total_pages||1}catch(o){v.value=o.message||"Failed to fetch orders",console.error("Error fetching vendor orders:",o)}finally{g.value=!1}},D=()=>{v.value=null,b()},M=()=>{e.push("/dashboard")},w=()=>{p.value>1&&(p.value--,b())},E=()=>{p.value<f.value&&(p.value++,b())},B=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=o=>{const i=o.toLowerCase();return i.includes("pending")||i.includes("placed")?"status-pending":i.includes("processing")?"status-processing":i.includes("shipped")?"status-shipped":i.includes("delivered")?"status-delivered":i.includes("cancelled")?"status-cancelled":"status-default"},A=o=>{n.value=o,c.value=o.status,a.value=!0},k=()=>{a.value=!1,n.value=null,c.value=""},F=async()=>{if(!(!n.value||!c.value)){m.value=!0;try{await P.updateOrderStatus(n.value.id,c.value);const o=t.value.findIndex(i=>i.id===n.value?.id);o!==-1&&t.value[o]&&(t.value[o].status=c.value),k(),alert("Order status updated successfully!")}catch(o){alert(o.message||"Failed to update order status. Please try again."),console.error("Error updating order status:",o)}finally{m.value=!1}}};return $(()=>{b()}),{orders:t,loading:g,error:v,page:p,totalPages:f,showStatusModal:a,selectedOrder:n,selectedStatus:c,updatingStatus:m,availableStatuses:O,goBack:M,retry:D,prevPage:w,nextPage:E,formatDate:B,getStatusClass:L,openStatusModal:A,closeStatusModal:k,updateStatus:F}}}),G={class:"vendor-orders-page"},H={class:"orders-header"},R={key:0,class:"loading-state"},T={key:1,class:"error-state"},Y={class:"error-message"},q={key:2,class:"empty-state"},z={key:3,class:"orders-list"},Q={class:"order-header"},j={class:"order-info"},J={class:"order-date"},K={class:"order-status-section"},W=["onClick"],X={class:"order-items"},Z={class:"item-details"},x={class:"item-meta"},ss={class:"item-total"},es={class:"order-footer"},ts={class:"shipping-address"},as={class:"customer-info"},os={class:"order-total"},ls={class:"total-amount"},ns={key:0,class:"pagination"},ds=["disabled"],rs=["disabled"],is={class:"modal-header"},us={class:"modal-body"},ps={class:"order-id-text"},cs={class:"status-options"},vs=["onClick"],gs={class:"status-info"},fs={class:"modal-footer"},bs=["disabled"];function ms(e,t,g,v,p,f){return r(),d("div",G,[s("header",H,[t[10]||(t[10]=s("h1",null,"Customer Orders",-1)),s("button",{class:"back-btn",onClick:t[0]||(t[0]=(...a)=>e.goBack&&e.goBack(...a))},"â† Back to Dashboard")]),e.loading&&e.orders.length===0?(r(),d("div",R,[...t[11]||(t[11]=[s("div",{class:"spinner"},null,-1),s("p",null,"Loading orders...",-1)])])):e.error?(r(),d("div",T,[s("p",Y,l(e.error),1),s("button",{onClick:t[1]||(t[1]=(...a)=>e.retry&&e.retry(...a))},"Try Again")])):e.orders.length===0?(r(),d("div",q,[t[12]||(t[12]=s("div",{class:"empty-icon"},"ðŸ“¦",-1)),t[13]||(t[13]=s("h2",null,"No Orders Yet",-1)),t[14]||(t[14]=s("p",null,"You haven't received any orders for your products yet.",-1)),s("button",{class:"dashboard-btn",onClick:t[2]||(t[2]=(...a)=>e.goBack&&e.goBack(...a))},"Go to Dashboard")])):(r(),d("div",z,[(r(!0),d(S,null,h(e.orders,a=>(r(),d("div",{key:a.id,class:"order-card"},[s("div",Q,[s("div",j,[s("h3",null,"Order #"+l(a.id),1),s("p",J,l(e.formatDate(a.created_at_utc)),1)]),s("div",K,[s("span",{class:y(["status-badge",e.getStatusClass(a.status)])},l(a.status),3),s("button",{class:"update-status-btn",onClick:n=>e.openStatusModal(a)}," Update Status ",8,W)])]),s("div",X,[(r(!0),d(S,null,h(a.items,n=>(r(),d("div",{key:n.id,class:"order-item"},[s("div",Z,[s("h4",null,l(n.product_name),1),s("p",x," Quantity: "+l(n.quantity)+" Ã— â‚¹"+l(n.product_price.toFixed(2)),1)]),s("div",ss,"â‚¹"+l(n.total_price.toFixed(2)),1)]))),128))]),s("div",es,[s("div",ts,[t[15]||(t[15]=s("strong",null,"Shipping Address:",-1)),s("p",null,l(a.shipping_address),1)]),s("div",as,[t[16]||(t[16]=s("strong",null,"Customer ID:",-1)),s("p",null,"#"+l(a.customer_id),1)]),s("div",os,[t[17]||(t[17]=s("strong",null,"Total Amount:",-1)),s("span",ls,"â‚¹"+l(a.total_amount.toFixed(2)),1)])])]))),128)),e.totalPages>1?(r(),d("div",ns,[s("button",{disabled:e.page===1,onClick:t[3]||(t[3]=(...a)=>e.prevPage&&e.prevPage(...a))},"Previous",8,ds),s("span",null,"Page "+l(e.page)+" of "+l(e.totalPages),1),s("button",{disabled:e.page===e.totalPages,onClick:t[4]||(t[4]=(...a)=>e.nextPage&&e.nextPage(...a))},"Next",8,rs)])):C("",!0)])),e.showStatusModal?(r(),d("div",{key:4,class:"modal-overlay",onClick:t[9]||(t[9]=(...a)=>e.closeStatusModal&&e.closeStatusModal(...a))},[s("div",{class:"modal-content",onClick:t[8]||(t[8]=U(()=>{},["stop"]))},[s("div",is,[t[18]||(t[18]=s("h2",null,"Update Order Status",-1)),s("button",{class:"close-btn",onClick:t[5]||(t[5]=(...a)=>e.closeStatusModal&&e.closeStatusModal(...a))},"Ã—")]),s("div",us,[s("p",ps,"Order #"+l(e.selectedOrder?.id),1),s("div",cs,[(r(!0),d(S,null,h(e.availableStatuses,a=>(r(),d("button",{key:a.value,class:y(["status-option",{selected:e.selectedStatus===a.value}]),onClick:n=>e.selectedStatus=a.value},[s("span",{class:y(["status-icon",e.getStatusClass(a.value)])},"â—",2),s("div",gs,[s("strong",null,l(a.label),1),s("p",null,l(a.description),1)])],10,vs))),128))])]),s("div",fs,[s("button",{class:"cancel-btn",onClick:t[6]||(t[6]=(...a)=>e.closeStatusModal&&e.closeStatusModal(...a))},"Cancel"),s("button",{class:"confirm-btn",disabled:e.updatingStatus||!e.selectedStatus,onClick:t[7]||(t[7]=(...a)=>e.updateStatus&&e.updateStatus(...a))},l(e.updatingStatus?"Updating...":"Update Status"),9,bs)])])])):C("",!0)])}const ys=N(V,[["render",ms],["__scopeId","data-v-6ba834b4"]]);export{ys as default};
